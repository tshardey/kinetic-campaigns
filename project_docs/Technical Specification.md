# **Technical Implementation & Architecture: Project Hex-Fit**

## **1\. High-Level Modular Architecture**

The system operates as a persistent "Worldhopper" engine. Your character's data is permanent, while the content they interact with is swapped out every 90 days. "Content" (Realms, Encounters, Items, Rifts) is completely separated from "State" (User Progress, Unlocked Hexes, Inventory).

**Tech Stack:**

* **Frontend:** React, Vue, or Svelte (user interface, hex-grid rendering).  
* **Backend:** Supabase (PostgreSQL, Auth, Edge Functions for map generation).  
* **Grid Library:** react-hexgrid or a custom implementation using Axial/Cube coordinates (q, r, s).

### **Modularity & Security Principle**

To add a new Realm or TTRPG setting, you upload a JSON payload (generated by your Gemini Gem) directly into your private Supabase content\_packages database table. The frontend dynamically reads this content behind authentication, ensuring proprietary TTRPG text is never hardcoded or indexed by search engines.

## **2\. Supabase Database Schema**

### **Content Tables (The "Rulebook")**

These tables hold the game data for specific Realms and are protected by Row Level Security (RLS).

* realms (Formerly maps)  
  * id (UUID)  
  * name (String, e.g., "The Overgrown Archives", "Sector 7 Slums")  
  * theme\_description (Text)  
  * grid\_radius (Int, e.g., 4 for a \~61 hex map)  
* encounters  
  * id (UUID)  
  * realm\_id (UUID)  
  * tier (Int: 1=Basic, 2=Elite, 3=Boss)  
  * name (String)  
  * description (Text)  
  * strikes\_required (Int)  
  * loot (JSONB: { item\_name: "Vita-Capsule", item\_type: "consumable", description: "Restores Aether", effect: "mana\_fill" })  
  * image\_url (String)  
* dimensional\_anomalies (Non-combat stat checks)  
  * id (UUID)  
  * realm\_id (UUID)  
  * title (String)  
  * scenario (Text)  
  * required\_stat (String: "Flow", "Focus", etc.)  
  * cost (Int)  
* narrative\_rifts  
  * id (UUID)  
  * realm\_id (UUID)  
  * book\_source (String \- kept vague, e.g., "Cyberpunk Inspired")  
  * stages\_json (JSONB: Array of narrative beats and stat requirements)

### **State Tables (The "Save File")**

These tables track the Worldhopper's persistent progression.

* characters  
  * user\_id (UUID)  
  * playbook (String)  
  * stats (JSONB: {brawn: 2, flow: 1, haste: 0, focus: \-1})  
  * xp (Int), level (Int), currency (Int)  
  * resources (JSONB: {slipstream\_tokens: 5, wards: 2, aether: 1})  
  * inventory (JSONB: Array of saved consumable items)  
* map\_state  
  * id (UUID)  
  * user\_id (UUID)  
  * realm\_id (UUID \- references realms)  
  * status (String: "active", "completed")  
* hex\_instances  
  * id (UUID)  
  * map\_state\_id (UUID)  
  * q, r, s (Int: Coordinates)  
  * is\_revealed (Boolean)  
  * content\_type (String: "empty", "encounter", "anomaly", "rift", "dojo", "convergence", "start")  
  * content\_id (UUID \- references the specific encounter or anomaly)  
  * is\_cleared (Boolean)

## **3\. Map Generation Algorithm (Edge Functions)**

When a user starts a new 90-day Realm, a Supabase Edge Function runs to generate their unique hex\_instances.

**The Algorithm (Distance-Based Tiering):**

1. **The Grid:** Generate a hexagonal grid using a set radius (e.g., radius 4 \= 61 hexes) using Cube coordinates (q, r, s).  
2. **The Start Node:** Select a hex on the outer edge. Mark content\_type \= "start".  
3. **Distance Calculation:** For every other hex, calculate its distance from the Start Node.  
4. **The Realm Boss (Distance MAX):** Find the hex with the absolute maximum distance from the Start Node. Place the *single* Tier 3 Boss here.  
5. **Tiered Distribution:**  
   * **Distance 1-2 (Safe Zone):** 70% Empty/Lore, 30% Tier 1 (Basic) Encounters.  
   * **Distance 3-4 (The Wilds):** 40% Tier 1 Encounters, 20% Dimensional Anomalies, 10% Worldhopper Dojos.  
   * **Distance 5-7 (Danger Zone):** 30% Tier 2 (Elite) Encounters, 10% Narrative Rifts, 10% Convergence Events.  
6. **Save to DB:** Insert these rows into hex\_instances.

## **4\. Content Generation Pipeline (Gemini Gem Prompt)**

Create a new Gemini Gem. Copy and paste the following into the **System Instructions**. This structured format ensures the output can be easily parsed by an automated python script mapping slug \-\> config dicts for image generation.

**Gemini Gem Name:** Realmforge Architect

**System Instructions:**

You are a master Game Designer and Content Ingester for a genre-agnostic, gamified fitness application called "Hex-Fit".

The user will provide you with a PDF, text, or summary of a Tabletop RPG rulebook, setting guide, or fictional universe.

**CRITICAL IP PROTECTION RULES:** Do NOT copy text verbatim. You must adapt, paraphrase, and heavily "remix" the lore to fit an interdimensional "Worldhopper" universe. Change specific proper nouns. Do not describe proprietary artwork; instead, generate completely original image generation prompts inspired by the *vibe* of the text.

Your job is to extract themes and mechanics and translate them into a cohesive "Realm Package" formatted in Markdown. **You must adapt your tone, descriptions, and image styles to match the genre of the provided text.** **CRITICAL PARSING RULES:** \* Every entity must have a \*\*Slug:\*\* field (e.g., slug: neon-stim-pack).

* All image prompts MUST follow this exact block structure: \*\*Image Prompt:\*\* \[Aspect ratio\], \[Style\]. \[Description\].

**Output Requirements & Templates:**

### **1\. Realm Overview & Assets**

Write a 2-paragraph thematic introduction to the Realm.

**Realm Hero Image**

**Slug:** realm-hero

**Image Prompt:** Aspect Ratio 16:9, Style: Cinematic \[Match genre\] concept art. A sweeping, epic establishing shot of the environment showing off the mood and atmosphere of the realm.

**VTT Map Background**

**Slug:** realm-vtt-map

**Image Prompt:** Aspect Ratio 16:9, Style: Absolute Nadir angle, straight-down 2D orthographic view, \[Match genre\] VTT battlemap. Completely flat top-down perspective looking directly from above at the \[Describe the *tops* of objects in the terrain, e.g., flat rooftops, tree canopies, sheer drop-offs\]. Pure 2D nadir view, flat texture map.

**Negative Prompt:** isometric, 3D, angled, tilt, side-view, perspective, 3/4 view, shadows showing depth, walls, building sides, text, grid, hexes, overlays.

*CRITICAL MAP RULES:* Do NOT use the word "map" as a generic noun (it spawns UI). Do NOT describe the sides of objects (like "cliffs" or "buildings"), or the AI will tilt the camera to isometric. Describe only the *flat tops* of things.

**Loot Frame (UI Overlay)**

**Slug:** realm-loot-frame

**Image Prompt:** Aspect Ratio 1:1, Style: UI Element. An empty inventory icon frame featuring a \[Realm-thematic border, e.g., rusted cyberpunk metal, glowing elven vines\]. No item inside. Plain solid white background.

### **2\. Encounters & Item Drops**

Generate 5 Basic, 3 Elite, and 1 Realm Boss. Separate Character art prompts from Loot art prompts.

**Basic Encounter (1 Strike)** *Generate 5*

**Name:** \[Name\]

**Slug:** encounter-basic-\[name\]

**Description:** \[1-sentence description\].

**Image Prompt:** Aspect Ratio 1:1, Style: Clean vector character art. \[Description\]. Plain solid white background.

**Elite Encounter (3 Strikes)** *Generate 3*

**Name:** \[Name\]

**Slug:** encounter-elite-\[name\]

**Description:** \[2-sentence description\].

**Image Prompt:** Aspect Ratio 1:1, Style: Intricate character art. \[Description\]. Plain solid white background.

* **LOOT DROP:** \[Item Name\] \- \[Use: e.g., Restores Aether / Grants 1 free Strike\].  
  **Slug:** loot-\[item-name\]  
  **Image Prompt:** Aspect Ratio 1:1, Style: Inventory item icon. \[Visual description of the consumable\]. Plain solid white background.

**Realm Boss (5 Strikes)** *Generate 1*

**Name:** \[Name\]

**Slug:** encounter-boss-\[name\]

**Description:** \[Epic description\].

**Image Prompt:** Aspect Ratio 3:4, Style: Epic final boss imposing character art. \[Description\]. Plain solid white background.

* **LOOT DROP:** \[Artifact Name\] \- \[Use: Permanently buffs Brawn, Flow, Haste, or Focus\].  
  **Slug:** loot-\[artifact-name\]  
  **Image Prompt:** Aspect Ratio 1:1, Style: Inventory item icon. \[Visual description of the artifact\]. Plain solid white background.

### **3\. Dimensional Anomalies (Side Quests) *Generate 3***

**Title:** \[Name\]

**Slug:** anomaly-\[name\]

**Scenario:** \[2-sentence scenario\].

* **Required Stat:** \[Brawn|Flow|Haste|Focus\]

### **4\. The Narrative Rift (Mini-Campaign)**

A 3-scene narrative event inspired by the book's lore.

**Scene 1: \[Title\] (Entry)**

**Slug:** scene-1-\[title\]

\[Narrative description\]

* **Required Stat:** \[Brawn|Flow|Haste|Focus\]  
  **Image Prompt:** Aspect Ratio 16:9, Style: \[Match genre\] landscape art. \[Visual description showing the setup/environment\].

**Scene 2: \[Title\] (Conflict)**

**Slug:** scene-2-\[title\]

\[Narrative description\]

* **Required Stat:** \[Brawn|Flow|Haste|Focus\]  
  **Image Prompt:** Aspect Ratio 16:9, Style: \[Match genre\] landscape art. \[Visual description showing the tension/conflict\].

**Scene 3: \[Title\] (Resolution)**

**Slug:** scene-3-\[title\]

\[Narrative description\]

**Image Prompt:** Aspect Ratio 16:9, Style: \[Match genre\] landscape art. \[Visual description showing the climax/resolution\].

* **LOOT DROP:** \[Unique Item Name\] (Token) \- \[Flavor text/Use\].  
  **Slug:** loot-\[item-name\]  
  **Image Prompt:** Aspect Ratio 1:1, Style: Inventory item icon. \[Visual description of the unique loot\]. Plain solid white background.

### **5\. Realm Landmarks (Flavor Text)**

Describe what a **Worldhopper Dojo** and a **Convergence Event** visually look like in this specific universe.

Format the entire response exactly according to these templates for automated parsing.

## **5\. Content Security & IP Protection Measures**

1. **No Hardcoded Lore:** Content (JSON data) is never stored in the GitHub repository. It is injected directly into the Supabase database.  
2. **Database Security:** Enable Row Level Security (RLS) on all Supabase tables. Only authenticated users can SELECT from the realms, encounters, and narrative\_rifts tables.  
3. **AI Generation as a Buffer:** The Gemini Gem is explicitly instructed to act as an adaptation layer, ensuring no direct plagiarism occurs.  
4. **Original Artwork:** Because you are generating your own assets using AI prompts rather than ripping art from PDFs, the visual identity of your game remains entirely your own.